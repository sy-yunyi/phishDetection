'''
Descripttion: 
version: 
Author: Six
Date: 2021-06-05 14:42:59
LastEditors: Six
LastEditTime: 2021-06-05 20:34:50
'''
import tldextract

def getFQDN(domain):
    d_info = tldextract.extract(domain)
    if d_info.subdomain != "" and d_info.suffix != "":
        return d_info.subdomain, d_info.domain, d_info.suffix, d_info.subdomain+'.'+d_info.domain+'.'+d_info.suffix
    elif d_info.suffix != "":
        return d_info.subdomain, d_info.domain, d_info.suffix, d_info.domain+'.'+d_info.suffix
    elif d_info.subdomain != "":
        return d_info.subdomain, d_info.domain, d_info.suffix, d_info.subdomain+'.'+d_info.domain
    else:
        return d_info.subdomain, d_info.domain, d_info.suffix, d_info.domain


def baiduResult(keywords):
    results = []
    headers = {
        "cookie":"PSTM=1576459250; BIDUPSID=8D3C7AA1AFC6AED754051C4F9523B6D1; H_WISE_SIDS=154599_148077_145999_154210_133333_149355_150967_152056_150077_150085_148867_155684_156087_154804_151897_153716_153444_152410_131862_154798_151533_148303_127969_154413_154175_155962_152981_155516_150346_155318_146732_154603_152572_131423_154569_154037_154782_154189_155345_154791_151872_144966_153535_154619_154117_139882_154800_154903_155237_147546_152310_154289_155865_110085; COOKIE_SESSION=4002647_1_8_8_3_11_0_2_7_5_1_2_8640908_0_33_0_1607782699_1599141626_1607782666%7C9%231685_328_1599141623%7C9; MCITY=-140%3A; BAIDUID=8496718B96BD051775300767C9051F96:FG=1; BAIDUID_BFESS=8496718B96BD051775300767C9051F96:FG=1; sugstore=0; __yjs_duid=1_89cc62687d2d89d50578db60cb2934cf1609123465304; BD_HOME=1; H_PS_PSSID=33423_1462_33418_33306_33286_33350_33313_33312_33311_33310_33414_33309_26350_33308_33307_22159_33389_33386_33370; BD_UPN=12314753; BA_HECTOR=8k21042ha4a08g2kqf1fv7kvg0q",
        # "BAIDUID=BDC3E7C1E7E307DD9DD9EE92DF25BFAA:FG=1; BIDUPSID=BDC3E7C1E7E307DD9DD9EE92DF25BFAA; PSTM=1538125243; __yjs_duid=1_c64f4166c34761e278e27b4c953a65491609338577305; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; MSA_WH=540_720; BDICON=10294984.98; H_WISE_SIDS=107315_110085_127969_131423_132550_144966_154212_156071_156287_156849_158830_159383_160246_160933_161396_161965_162025_162156_162187_162898_163233_163250_163275_163321_163566_163808_163979_164131_164164_164216_164325_164371_164450_164692_164936_164941_164961_165070_165086_165136_165143_165158_165237_165294_165328_165423_165551_165646_165712_165717_165737_165767_165801_165840_165848_166166_166177_166181_166185_166216_166313_166403_166449_166484; BDSFRCVID=cUDOJeC62ZukD6orPMc0boxjvg7GFCRTH6aoJlUHed488LMabPSLEG0Pqx8g0KubhmPNogKK3gOTH4DF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF=tbkD_C-MfIvDqTrP-trf5DCShUFs2xRRB2Q-XPoO3KO6f4bnK4Ri268Vhp7B-tbiWbRM2MbgylRp8P3y0bb2DUA1y4vpWj3qLgTxoUJ2XMKVDq5mqfCWMR-ebPRiJPb9Qg-qahQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hI0ljj82e5PVKgTa54cbb4o2WbCQ2-ON8pcN2b5oQTt95lO2btnvMDcaW-n_bJ3vOIJTXpOUWfAkXpJvQnJjt2JxaqRCBDb-Vh5jDh3MBpQDhtoJexIO2jvy0hvctn3cShPCyUjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQhDGAtJ50ttRFsL-35HJbHDRTG2boq2-F_hgTybt-sWmJl2hcH0KLKMpc_0UQCKxCJMpja2bvBbDnt-P5qJxb1MRjv3jbJMb_j3abmJxjOLe6gVp5TtUJr8DnTDMRh-R8wW-5yKMnitKv9-pP23pQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuD6K-DjcXDaKs-bbfHD6L34cOajrjDCvtW4Rcy4LdjG5NLbckBTrH2JIXMRooJbcCbURHhf0X3-Aq54R8QCvpLR725P5rJ45PD5JWQfbQ0-7uqP-jW5TabC5tKb7JOpkRbUnxy50vQRPH-Rv92DQMVU52QqcqEIQHQT3m5-5bbN3ut6IHJnAHoIthtDvffPFRq4b_ePtAQ-nZKxtqtHQtBh-Ka-om8J8x-4nWMRKsjPJl3hjnWncKWhcsQlnqeK-9eMvY-tDr0Pv405OT-6-O0KJcbRosDfJ8hPJvyTtsXnO7tU3lXbrtXp7_2J0WStbKy4oTjxL1Db3JKjvMtgDtVJO-KKCMMDDxef5; BDSFRCVID_BFESS=cUDOJeC62ZukD6orPMc0boxjvg7GFCRTH6aoJlUHed488LMabPSLEG0Pqx8g0KubhmPNogKK3gOTH4DF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF_BFESS=tbkD_C-MfIvDqTrP-trf5DCShUFs2xRRB2Q-XPoO3KO6f4bnK4Ri268Vhp7B-tbiWbRM2MbgylRp8P3y0bb2DUA1y4vpWj3qLgTxoUJ2XMKVDq5mqfCWMR-ebPRiJPb9Qg-qahQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hI0ljj82e5PVKgTa54cbb4o2WbCQ2-ON8pcN2b5oQTt95lO2btnvMDcaW-n_bJ3vOIJTXpOUWfAkXpJvQnJjt2JxaqRCBDb-Vh5jDh3MBpQDhtoJexIO2jvy0hvctn3cShPCyUjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQhDGAtJ50ttRFsL-35HJbHDRTG2boq2-F_hgTybt-sWmJl2hcH0KLKMpc_0UQCKxCJMpja2bvBbDnt-P5qJxb1MRjv3jbJMb_j3abmJxjOLe6gVp5TtUJr8DnTDMRh-R8wW-5yKMnitKv9-pP23pQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuD6K-DjcXDaKs-bbfHD6L34cOajrjDCvtW4Rcy4LdjG5NLbckBTrH2JIXMRooJbcCbURHhf0X3-Aq54R8QCvpLR725P5rJ45PD5JWQfbQ0-7uqP-jW5TabC5tKb7JOpkRbUnxy50vQRPH-Rv92DQMVU52QqcqEIQHQT3m5-5bbN3ut6IHJnAHoIthtDvffPFRq4b_ePtAQ-nZKxtqtHQtBh-Ka-om8J8x-4nWMRKsjPJl3hjnWncKWhcsQlnqeK-9eMvY-tDr0Pv405OT-6-O0KJcbRosDfJ8hPJvyTtsXnO7tU3lXbrtXp7_2J0WStbKy4oTjxL1Db3JKjvMtgDtVJO-KKCMMDDxef5; delPer=0; BD_CK_SAM=1; PSINO=7; BAIDUID_BFESS=BDC3E7C1E7E307DD9DD9EE92DF25BFAA:FG=1; BD_HOME=1; BD_UPN=12314753; H_PS_PSSID=33423_1436_33430_33306_32974_33286_33350_33313_33312_33311_33310_33231_33334_33309_26350_33308_33307_22159_33389_33370; ZD_ENTRY=baidu; ab_sr=1.0.0_NzEzYjYyMTU1ZTU0ZmQ0NDg3NTQ5NDllNTJhNmI3YjdhN2JhMjRmNDJiZjgxOWM0NjgzZWI5YjkzZWE4MWVmZGEyNzFjNWVhOTU1YWMzMGQyNDBiZTNkY2IzMWY4NWRl; H_PS_645EC=f45cNth6Gciz%2F0ft08GrFr5ZnSu5kDvl%2B6cQj%2BfourYa%2BLyx0vITl%2FFFz6c; BA_HECTOR=0l000021a18485859s1fv67k60r",
        # "BAIDUID=BDC3E7C1E7E307DD9DD9EE92DF25BFAA:FG=1; BIDUPSID=BDC3E7C1E7E307DD9DD9EE92DF25BFAA; PSTM=1538125243; BD_UPN=12314753; __yjs_duid=1_c64f4166c34761e278e27b4c953a65491609338577305; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; MSA_WH=540_720; BDICON=10294984.98; H_WISE_SIDS=107315_110085_127969_131423_132550_144966_154212_156071_156287_156849_158830_159383_160246_160933_161396_161965_162025_162156_162187_162898_163233_163250_163275_163321_163566_163808_163979_164131_164164_164216_164325_164371_164450_164692_164936_164941_164961_165070_165086_165136_165143_165158_165237_165294_165328_165423_165551_165646_165712_165717_165737_165767_165801_165840_165848_166166_166177_166181_166185_166216_166313_166403_166449_166484; H_PS_PSSID=33423_1436_33306_32974_33286_33350_33313_33312_33311_33310_33231_33334_33309_26350_33308_33307_22159_33389_33370; BDSFRCVID=cUDOJeC62ZukD6orPMc0boxjvg7GFCRTH6aoJlUHed488LMabPSLEG0Pqx8g0KubhmPNogKK3gOTH4DF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF=tbkD_C-MfIvDqTrP-trf5DCShUFs2xRRB2Q-XPoO3KO6f4bnK4Ri268Vhp7B-tbiWbRM2MbgylRp8P3y0bb2DUA1y4vpWj3qLgTxoUJ2XMKVDq5mqfCWMR-ebPRiJPb9Qg-qahQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hI0ljj82e5PVKgTa54cbb4o2WbCQ2-ON8pcN2b5oQTt95lO2btnvMDcaW-n_bJ3vOIJTXpOUWfAkXpJvQnJjt2JxaqRCBDb-Vh5jDh3MBpQDhtoJexIO2jvy0hvctn3cShPCyUjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQhDGAtJ50ttRFsL-35HJbHDRTG2boq2-F_hgTybt-sWmJl2hcH0KLKMpc_0UQCKxCJMpja2bvBbDnt-P5qJxb1MRjv3jbJMb_j3abmJxjOLe6gVp5TtUJr8DnTDMRh-R8wW-5yKMnitKv9-pP23pQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuD6K-DjcXDaKs-bbfHD6L34cOajrjDCvtW4Rcy4LdjG5NLbckBTrH2JIXMRooJbcCbURHhf0X3-Aq54R8QCvpLR725P5rJ45PD5JWQfbQ0-7uqP-jW5TabC5tKb7JOpkRbUnxy50vQRPH-Rv92DQMVU52QqcqEIQHQT3m5-5bbN3ut6IHJnAHoIthtDvffPFRq4b_ePtAQ-nZKxtqtHQtBh-Ka-om8J8x-4nWMRKsjPJl3hjnWncKWhcsQlnqeK-9eMvY-tDr0Pv405OT-6-O0KJcbRosDfJ8hPJvyTtsXnO7tU3lXbrtXp7_2J0WStbKy4oTjxL1Db3JKjvMtgDtVJO-KKCMMDDxef5; BDSFRCVID_BFESS=cUDOJeC62ZukD6orPMc0boxjvg7GFCRTH6aoJlUHed488LMabPSLEG0Pqx8g0KubhmPNogKK3gOTH4DF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF_BFESS=tbkD_C-MfIvDqTrP-trf5DCShUFs2xRRB2Q-XPoO3KO6f4bnK4Ri268Vhp7B-tbiWbRM2MbgylRp8P3y0bb2DUA1y4vpWj3qLgTxoUJ2XMKVDq5mqfCWMR-ebPRiJPb9Qg-qahQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hI0ljj82e5PVKgTa54cbb4o2WbCQ2-ON8pcN2b5oQTt95lO2btnvMDcaW-n_bJ3vOIJTXpOUWfAkXpJvQnJjt2JxaqRCBDb-Vh5jDh3MBpQDhtoJexIO2jvy0hvctn3cShPCyUjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQhDGAtJ50ttRFsL-35HJbHDRTG2boq2-F_hgTybt-sWmJl2hcH0KLKMpc_0UQCKxCJMpja2bvBbDnt-P5qJxb1MRjv3jbJMb_j3abmJxjOLe6gVp5TtUJr8DnTDMRh-R8wW-5yKMnitKv9-pP23pQrh459XP68bTkA5bjZKxtq3mkjbPbDfn028DKuD6K-DjcXDaKs-bbfHD6L34cOajrjDCvtW4Rcy4LdjG5NLbckBTrH2JIXMRooJbcCbURHhf0X3-Aq54R8QCvpLR725P5rJ45PD5JWQfbQ0-7uqP-jW5TabC5tKb7JOpkRbUnxy50vQRPH-Rv92DQMVU52QqcqEIQHQT3m5-5bbN3ut6IHJnAHoIthtDvffPFRq4b_ePtAQ-nZKxtqtHQtBh-Ka-om8J8x-4nWMRKsjPJl3hjnWncKWhcsQlnqeK-9eMvY-tDr0Pv405OT-6-O0KJcbRosDfJ8hPJvyTtsXnO7tU3lXbrtXp7_2J0WStbKy4oTjxL1Db3JKjvMtgDtVJO-KKCMMDDxef5; delPer=0; BD_CK_SAM=1; PSINO=7; BAIDUID_BFESS=BDC3E7C1E7E307DD9DD9EE92DF25BFAA:FG=1; kleck=2cb2a6d6f51dc2200ca8a6fd1815ae11; H_PS_645EC=f5f9ocXHJ0jRKWcfQRG%2B%2Bf3l%2F0bPvuBX7yAf81wQkifq6sdwk1xLEia5O4s; BA_HECTOR=ak0h2l2ha50ga025a71fv3fmj0r; BDSVRTM=75",
        # "BAIDUID=BDC3E7C1E7E307DD9DD9EE92DF25BFAA:FG=1; BIDUPSID=BDC3E7C1E7E307DD9DD9EE92DF25BFAA; PSTM=1538125243; BD_UPN=12314753; H_WISE_SIDS=164371_152522_160933_161581_164936_156287_163808_159610_162898_155225_159547_163303_165328_159383_162179_162175_161124_163396_164692_127969_164164_160246_165294_164941_163979_164950_164620_163338_163290_131423_164150_163250_156071_132550_165423_164216_107315_158830_160572_161965_165070_163538_144966_164259_162187_154212_158640_156849_163747_164131_163382_162526_161771_165208_164450_162642_159092_162156_110085_162025_163321_163568_163566_164961_163275_164128_165143; MSA_WH=3248_1656; sugstore=0; __yjs_duid=1_c64f4166c34761e278e27b4c953a65491609338577305; H_PS_PSSID=33423_1436_33306_32974_33286_33350_33313_33312_33311_33310_33231_33334_33309_26350_33308_33307_22159_33389_33370; BDORZ=B490B5EBF6F3CD402E515D22BCDA1598; BDSFRCVID=BZkOJeC62RWyYLrrNi9yboxjvgKamDrTH6aoyUgVuotdu_zub07xEG0PHM8g0KubQ5bcogKK3gOTH4DF_2uxOjjg8UtVJeC6EG0Ptf8g0M5; H_BDCLCKID_SF=tbkD_C-MfIvDqTrP-trf5DCShUFsXt7WB2Q-XPoO3KO6f4bnK4Ri26DVhp7B-tbiWbRM2MbgylRp8P3y0bb2DUA1y4vpWj3qLgTxoUJ2XMKVDq5mqfCWMR-ebPRiJPb9Qg-qahQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hI0ljj82e5PVKgTa54cbb4o2WbCQal7U8pcN2b5oQTt95lO2btnvMJRaW-n_bJ3vOIJTXpOUWfAkXpJvQnJjt2JxaqRCBDb-Vh5jDh3MBpQDhtoJexIO2jvy0hvctn3cShPCyUjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQhDNtDt60jfn3aQ5rtKRTffjrnhPF3MntFXP6-hnjy3b7gLtbJ-JviJRQPhn7854-UyN3MWh3RymJ42-39LPO2hpRjyxv4X60B0-oxJpOJXaILWl52HlFWj43vbURvD--g3-AqBM5dtjTO2bc_5KnlfMQ_bf--QfbQ0hOhqP-jBRIEoDPatK-hhDLr5nJbq40_hxrthnQ-MI5KW5rO-J03OqRDXU6qLT5XjP6ZQMoN-eo3B-Qta-n8fRbG3boHjq0njxQyL6JM2T6Q-IOntloWVljbeMonDh8mXH7MJUntKjRNhpoO5hvvhn3O3MAMQMKmDloOW-TB5bbPLUQF5l8-sq0x0bOte-bQXH_EJjDqtRKHoI_Qb-3bKRjz-J6ohCCShGRGXtn9WDTm_Do4Q-TZ8-o4X4uB2tDe2M6qKMnKamnH-pPKKR7BSJ3K5tnMbbLm2loaJTbO3mkjbpnzfn02OP5P0joD-P4syP4eKMRnWnnRKfA-b4ncjRcTehoM3xI8LNj405OTbIFO0KJzJCcjqR8ZDT-BjTvP; H_BDCLCKID_SF_BFESS=tbkD_C-MfIvDqTrP-trf5DCShUFsXt7WB2Q-XPoO3KO6f4bnK4Ri26DVhp7B-tbiWbRM2MbgylRp8P3y0bb2DUA1y4vpWj3qLgTxoUJ2XMKVDq5mqfCWMR-ebPRiJPb9Qg-qahQ7tt5W8ncFbT7l5hKpbt-q0x-jLTnhVn0MBCK0hI0ljj82e5PVKgTa54cbb4o2WbCQal7U8pcN2b5oQTt95lO2btnvMJRaW-n_bJ3vOIJTXpOUWfAkXpJvQnJjt2JxaqRCBDb-Vh5jDh3MBpQDhtoJexIO2jvy0hvctn3cShPCyUjrDRLbXU6BK5vPbNcZ0l8K3l02V-bIe-t2XjQhDNtDt60jfn3aQ5rtKRTffjrnhPF3MntFXP6-hnjy3b7gLtbJ-JviJRQPhn7854-UyN3MWh3RymJ42-39LPO2hpRjyxv4X60B0-oxJpOJXaILWl52HlFWj43vbURvD--g3-AqBM5dtjTO2bc_5KnlfMQ_bf--QfbQ0hOhqP-jBRIEoDPatK-hhDLr5nJbq40_hxrthnQ-MI5KW5rO-J03OqRDXU6qLT5XjP6ZQMoN-eo3B-Qta-n8fRbG3boHjq0njxQyL6JM2T6Q-IOntloWVljbeMonDh8mXH7MJUntKjRNhpoO5hvvhn3O3MAMQMKmDloOW-TB5bbPLUQF5l8-sq0x0bOte-bQXH_EJjDqtRKHoI_Qb-3bKRjz-J6ohCCShGRGXtn9WDTm_Do4Q-TZ8-o4X4uB2tDe2M6qKMnKamnH-pPKKR7BSJ3K5tnMbbLm2loaJTbO3mkjbpnzfn02OP5P0joD-P4syP4eKMRnWnnRKfA-b4ncjRcTehoM3xI8LNj405OTbIFO0KJzJCcjqR8ZDT-BjTvP; delPer=0; BD_CK_SAM=1; PSINO=7; BAIDUID_BFESS=BDC3E7C1E7E307DD9DD9EE92DF25BFAA:FG=1; kleck=4933316d437328e169a029b4ae3e7fa9; BD_HOME=1; H_PS_645EC=46cdDsVfTLH2M2HzQugJFjy2WL7b82VovkFeaQfPFcqbZcwqQ%2BrTmk6uRto; BA_HECTOR=ala08ka1ak040184ck1fv0c9j0r",
        # "BAIDUID=BDC3E7C1E7E307DD9DD9EE92DF25BFAA:FG=1; BIDUPSID=BDC3E7C1E7E307DD9DD9EE92DF25BFAA; PSTM=1538125243; BD_UPN=12314753; COOKIE_SESSION=20_3_8_3_8_6_0_1_6_4_32_2_0_0_7_2_1603723922_1603723917_1603723915%7C9%231055265_7_1603723915%7C4; BDRCVFR[k2U9xfnuVt6]=mk3SLVN4HKm; BD_HOME=1; delPer=0; BD_CK_SAM=1; PSINO=7; BDORZ=FFFB88E999055A3F8A630C64834BD6D0; H_PS_645EC=4322p2m%2FiRcjVS9TznaiZ%2FPbLhG%2FIXxsA1bv65DqmpqQjY0YYQZEr68K5U1IgRcAMcivyg; BA_HECTOR=8g812h0h0001217c1n1fpf54v0k; H_PS_PSSID=32758_1436_32854_32952_32723_32230_7517_7605_32116_26350_22159",
        "Host":"www.baidu.com",
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36 Edg/86.0.622.51",
        "Referer": "https://www.baidu.com/"
    }
    proxies = {
    "https": "https://127.0.0.1:1080",
    "http:": "https://127.0.0.1:1080"
            }
    # proxies = getProxy()
    url = "https://www.baidu.com/s?wd={}&pn=0&rn=10&ie=UTF-8".format("%20".join(keywords))
    snums = 0
    num_flag = 0 
    try:
        res = requests.get(url,headers=headers,proxies=proxies,timeout=5)
        if len(res.text) < 10 : # 第一次可能获取不到数据
            res = requests.get(url,headers=headers,timeout=5)
        # pdb.set_trace()
        print(keywords)
        if res.status_code==200:
            th = etree.HTML(res.text)

            nums = th.xpath('//*[@id="content_left"]/div[1]/div/p[1]/b/text()')
            if len(nums)==0:
                nums = th.xpath('//*[@id="1"]/div/div[1]/div/p[3]/span/b/text()')

                if len(nums)==0:
                    if "没有找到" in res.text:
                        return 0,[] 
                else:
                    if "亿" in nums:
                        numbers = re.findall(r"\d+",nums[0])
                        snums = str(numbers[0] * 1000000000 + numbers[1] *10000)
                    else:
                        snums = "".join(re.findall(r"\d+",nums[0]))
            else:
                snums = "".join(re.findall(r"\d+",nums[0]))
            # print(snums)

            for ti in th.xpath('/html/body/div[1]/div[3]/div[1]/div[3]/div[@class="result c-container new-pmd"]'):
                try:
                    # print(ti.xpath("./h3/a/@href")[0])
                    tmpi = requests.get(ti.xpath("./h3/a/@href")[0],proxies=proxies,timeout=10).url
                    results.append(tmpi)
                    print(tmpi)
                except Exception as e:
                    print(e)
                    raise(e)
    except Exception as e:
        print(e)
        # raise(e)
    
    if snums==0:
        snums = len(results)
    return snums,results